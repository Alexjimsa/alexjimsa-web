---
import PostLayout from '../../layouts/PostLayout.astro';
import { getCollection, render } from 'astro:content';

export async function getStaticPaths() {
  const entries = await getCollection('projects', (e) => e.data.lang === 'es' && (e.data.published ?? true));
  return entries
    .filter((e) => !!e.data.slug)
    .map((entry) => ({
      params: { slug: entry.data.slug! },
      props: { entry },
    }));
}

const { entry } = Astro.props;
const { data } = entry;
const { Content } = await render(entry);

const metaTitle = data.seoTitle ?? data.title;
const metaDesc  = data.seoDescription ?? data.excerpt ?? data.title;
---
<PostLayout
  title={data.title}
  section="projects"
  metaTitle={metaTitle}
  metaDesc={metaDesc}
  lang="es"
  class="prose"
>
  <article>
    <h1>{data.title}</h1>
    {data.heroImage && <img src={data.heroImage} alt={data.title} />}

    {data.stack?.length > 0 && (
      <ul>
        {data.stack.map((tech) => <li>{tech}</li>)}
      </ul>
    )}

    {(data.repoUrl || data.demoUrl) && (
      <p>
        {data.repoUrl && <a href={data.repoUrl}>Repositorio</a>}
        {' '}
        {data.demoUrl && <a href={data.demoUrl}>Demo</a>}
      </p>
    )}

    <Content />
  </article>
</PostLayout>
