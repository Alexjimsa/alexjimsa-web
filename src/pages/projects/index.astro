---
import DefaultLayout from '../../layouts/DefaultLayout.astro';

import { getCollection } from 'astro:content';

const all = await getCollection('projects');

const toMs = (d?: Date) => (d ? d.getTime() : 0);

const projects = all
  .filter((e) => e.data.lang === 'es')
  .sort((a, b) => toMs(b.data.date) - toMs(a.data.date));
---
<DefaultLayout>
  <h1>Proyectos</h1>
  {projects.length === 0 ? (
    <p>No hay proyectos todav√≠a.</p>
  ) : (
    <ul>
      {projects.map((p) =>
        p.data.slug && (
          <li>
            <a href={`/projects/${p.data.slug}`}>{p.data.title}</a>
            {p.data.excerpt && <p>{p.data.excerpt}</p>}
          </li>
        )
      )}
    </ul>
  )}
</DefaultLayout>
